"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6992],{6992:(I,p,u)=>{u.r(p),u.d(p,{MaquinaExpendedoraDetailPageModule:()=>y});var m=u(177),a=u(4341),r=u(9203),c=u(8986),o=u(4438),d=u(467),f=u(1016),F=u(5312);const{apiUrl:k}=F.c;let S=(()=>{var e;class s{constructor(){}getSlotByMaquinaId(t){return(0,d.A)(function*(){try{return(yield f.A.get(`${k}/slots?maquina_id=${t}`)).data}catch(n){return console.error("Error al obtener listado:",n),[]}})()}updateSlot(t,n){return(0,d.A)(function*(){try{return(yield f.A.patch(`${k}/slots/${t}`,n)).data}catch(l){return console.error("updateSlot()",l),null}})()}}return(e=s).\u0275fac=function(t){return new(t||e)},e.\u0275prov=o.jDH({token:e,factory:e.\u0275fac,providedIn:"root"}),s})();var g=u(423);function v(e,s){if(1&e&&(o.j41(0,"ion-select-option",12),o.EFF(1),o.k0s()),2&e){const i=s.$implicit;o.Y8G("value",i.id),o.R7$(),o.SpI(" ",i.nombre," ")}}function E(e,s){if(1&e){const i=o.RV6();o.j41(0,"form",2),o.bIt("ngSubmit",function(){o.eBV(i);const n=o.XpG().index,l=o.XpG();return o.Njj(l.setSlot(n))}),o.j41(1,"ion-label")(2,"b"),o.EFF(3),o.k0s()(),o.j41(4,"ion-item")(5,"ion-label",3),o.EFF(6,"Producto"),o.k0s(),o.j41(7,"ion-select",4),o.DNE(8,v,2,2,"ion-select-option",5),o.k0s()(),o.j41(9,"ion-item")(10,"ion-label"),o.EFF(11,"Precio"),o.k0s(),o.nrm(12,"ion-input",6),o.k0s(),o.j41(13,"ion-item")(14,"ion-label"),o.EFF(15,"Precio Oferta"),o.k0s(),o.nrm(16,"ion-input",7),o.k0s(),o.j41(17,"ion-item")(18,"ion-label"),o.EFF(19,"Stock"),o.k0s(),o.nrm(20,"ion-input",8),o.k0s(),o.j41(21,"ion-item")(22,"ion-label"),o.EFF(23,"Stock M\xednimo"),o.k0s(),o.nrm(24,"ion-input",9),o.k0s(),o.j41(25,"ion-item")(26,"ion-label"),o.EFF(27,"Capacidad de Slot"),o.k0s(),o.nrm(28,"ion-input",10),o.k0s(),o.j41(29,"ion-button",11),o.EFF(30," Actualizar "),o.k0s()()}if(2&e){const i=o.XpG(),t=i.$implicit,n=i.index,l=o.XpG();o.Y8G("formGroup",l.slotForms[n]),o.R7$(3),o.SpI("Slot: ",t.slot_num," "),o.R7$(5),o.Y8G("ngForOf",l.productos),o.R7$(21),o.Y8G("disabled",l.slotForms[n].invalid)}}function C(e,s){if(1&e&&(o.j41(0,"ion-item"),o.DNE(1,E,31,4,"form",1),o.k0s()),2&e){const i=s.index,t=o.XpG();o.R7$(),o.Y8G("ngIf",t.slotForms[i])}}let M=(()=>{var e;class s{constructor(t,n,l){this.slotService=t,this.fb=n,this.productoService=l,this.slots=[],this.productos=[],this.slotForms=[]}ngOnInit(){var t=this;return(0,d.A)(function*(){t.maquinaId&&(t.slots=yield t.slotService.getSlotByMaquinaId(t.maquinaId),t.productos=yield t.productoService.getProducts(),t.slots.forEach(n=>{const l=t.fb.group({producto_id:[n.producto_id||null,a.k0.required],precio:[null==n?void 0:n.precio,[a.k0.required,a.k0.min(0)]],precio_oferta:[n.precio_oferta,[a.k0.required,a.k0.min(0)]],stock:[n.stock,[a.k0.required,a.k0.min(0)]],stock_minimo:[n.stock_minimo,[a.k0.required,a.k0.min(0)]],stock_inicial:[n.stock_inicial,[a.k0.required,a.k0.min(0)]]});t.slotForms.push(l)}))})()}setSlot(t){var n=this;return(0,d.A)(function*(){try{if(n.slotForms[t].valid){const l=n.slots[t].id,b=n.slotForms[t].value;yield n.slotService.updateSlot(l,b),alert("Actualizado correctamente")}}catch{alert("No se pudo actualizar")}})()}}return(e=s).\u0275fac=function(t){return new(t||e)(o.rXU(S),o.rXU(a.ok),o.rXU(g.o))},e.\u0275cmp=o.VBU({type:e,selectors:[["app-slot-crud"]],inputs:{maquinaId:"maquinaId"},decls:2,vars:1,consts:[[4,"ngFor","ngForOf"],[3,"formGroup","ngSubmit",4,"ngIf"],[3,"ngSubmit","formGroup"],["position","stacked"],["formControlName","producto_id","placeholder","Seleccione un producto"],[3,"value",4,"ngFor","ngForOf"],["type","number","formControlName","precio"],["type","number","formControlName","precio_oferta"],["type","number","formControlName","stock"],["type","number","formControlName","stock_minimo"],["type","number","formControlName","stock_inicial"],["expand","block","type","submit",3,"disabled"],[3,"value"]],template:function(t,n){1&t&&(o.j41(0,"ion-list"),o.DNE(1,C,2,1,"ion-item",0),o.k0s()),2&t&&(o.R7$(),o.Y8G("ngForOf",n.slots))},dependencies:[m.Sq,m.bT,a.qT,a.BC,a.cb,r.Jm,r.$w,r.uz,r.he,r.nf,r.Nm,r.Ip,r.su,r.Je,a.j4,a.JD]}),s})();const h=[{path:"",component:(()=>{var e;class s{constructor(t){this.route=t}ngOnInit(){this.maquinaId=this.route.snapshot.paramMap.get("uuid")}}return(e=s).\u0275fac=function(t){return new(t||e)(o.rXU(c.nX))},e.\u0275cmp=o.VBU({type:e,selectors:[["app-maquina-expendedora-detail"]],decls:15,vars:4,consts:[[3,"translucent"],["color","main"],["slot","start"],["routerLink","/maquina-expendedora-list"],["color","light",3,"fullscreen"],[1,"container"],[3,"maquinaId"]],template:function(t,n){1&t&&(o.j41(0,"ion-header",0)(1,"ion-toolbar",1)(2,"ion-buttons",2),o.nrm(3,"ion-menu-button"),o.k0s(),o.j41(4,"ion-title",3),o.EFF(5,"Maquinas Expendedoras"),o.k0s()()(),o.j41(6,"ion-content",4)(7,"div",5)(8,"ion-card")(9,"ion-card-header")(10,"ion-card-title"),o.EFF(11,"Maquinas Detalle "),o.k0s()(),o.EFF(12),o.nrm(13,"app-slot-crud",6)(14,"ion-card-content"),o.k0s()()()),2&t&&(o.Y8G("translucent",!1),o.R7$(6),o.Y8G("fullscreen",!0),o.R7$(6),o.SpI(" ",n.maquinaId," "),o.R7$(),o.Y8G("maquinaId",n.maquinaId))},dependencies:[r.QW,r.b_,r.I9,r.ME,r.tN,r.W9,r.eU,r.MC,r.BC,r.ai,r.N7,c.Wk,M]}),s})()}];let q=(()=>{var e;class s{}return(e=s).\u0275fac=function(t){return new(t||e)},e.\u0275mod=o.$C({type:e}),e.\u0275inj=o.G2t({imports:[c.iI.forChild(h),c.iI]}),s})(),y=(()=>{var e;class s{}return(e=s).\u0275fac=function(t){return new(t||e)},e.\u0275mod=o.$C({type:e}),e.\u0275inj=o.G2t({imports:[m.MD,a.YN,r.bv,q,a.X1]}),s})()}}]);